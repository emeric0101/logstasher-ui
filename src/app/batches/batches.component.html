<h1 *ngIf="errorMsg" class="error">{{errorMsg}}</h1>

<p-card header="Batches" *ngIf="!errorMsg">

    <button class="ui-button-success" pButton label="New batch" [disabled]="errorMsg" (click)="onNewBatch()"></button>
    <br />
    <p-table [value]="batches">
        <ng-template pTemplate="header">
            <tr>
                <th>ID</th>
                <th>Active</th>
                <th>Order</th>
                <th>Start time (HH:mm)</th>
                <th>Timeout</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item>
            <tr>
                <td>{{item.id}}</td>
                <td>
                    <p-checkbox [(ngModel)]="item.activated" binary="true" (onChange)="save(item)"></p-checkbox>
                </td>
                <td>{{item.order}}</td>
                <td>
                    <input type="number" min="0" max="23" pInputText [(ngModel)]="item.startHour"
                        (ngModelChange)="save(item)" placeholder="hour">
                    <input type="number" pInputText min="0" max="59" [(ngModel)]="item.startMinute"
                        (ngModelChange)="save(item)" placeholder="minute">
                </td>
                <td> <input type="number" min="1" max="600" pInputText [(ngModel)]="item.timeout"
                        (ngModelChange)="save(item)" placeholder="timeout"> (min)
                </td>
                <td>
                    <button pButton type="button" label="Manage requests" (click)="editRest(item)"></button>
                    <button pButton type="button" label="Edit" (click)="edit(item)"></button>
                    <button pButton type="button" label="Delete" (click)="delete(item)"
                        class="ui-button-error"></button>
                    <button pButton type="button" [disabled]="isLogstashRunning()" label="Start" (click)="start(item)"
                        class="ui-button-success"></button>
                </td>
            </tr>
        </ng-template>
    </p-table>
</p-card>

<p-dialog header="New batch" [(visible)]="displayNew">
    <app-batches-create (updated)="ngOnInit(); displayNew = false;"></app-batches-create>
</p-dialog>


<p-dialog header="Edit batch" [(visible)]="displayEdit">
    <app-batches-edit *ngIf="editBatch" [batch]="editBatch" (onFinish)="displayEdit = false;"></app-batches-edit>
</p-dialog>

<p-dialog header="Edit batch" [(visible)]="displayRestEdit">
    <app-edit-rest-request *ngIf="editBatch" [batch]="editBatch" (onFinish)="displayRestEdit = false;"></app-edit-rest-request>
</p-dialog>